import{_ as k,o as h,c as u,F as w,b as C,a as t,t as _,h as S,w as M,v as b,d as I,p as $,j as P,s as T,f as U,T as B,m as V,r as f,B as W,e as D,g as L,n as j,u as O,C as z,z as N,D as q}from"./index-wT4GQKR0.js";const J={data(){return{menu:[{id:0,title:"Новое",progress:"Warning",delivery:{counter:0}},{id:1,title:"В работе",progress:"inProgress",delivery:{counter:0}},{id:2,title:"Завершенные",progress:"Done",delivery:{counter:0}}],deliveryInfoWaiting:null}},props:{newDeliveryWaiting:{type:Object},newDeliveryInProgress:{type:Object},newDeliveryDone:{type:Object}},watch:{newDeliveryWaiting(){this.updateMenuData()},newDeliveryInProgress(){this.updateMenuData()},newDeliveryDone(){this.updateMenuData()}},methods:{updateMenuData(){this.newDeliveryWaiting&&(this.menu[0].delivery=this.newDeliveryWaiting),this.newDeliveryInProgress&&(this.menu[1].delivery=this.newDeliveryInProgress),this.newDeliveryDone&&(this.menu[2].delivery=this.newDeliveryDone),this.selectedOptions(0)},selectedOptions(e){document.querySelectorAll(".options-button").forEach((a,s)=>{s===e?a.classList.add("active__options"):a.classList.remove("active__options")}),this.$emit("postTitleDelivery",this.menu[e].progress),this.$nextTick(()=>{let a=this.menu[e];if(a&&a.delivery){let s=a.delivery.value;console.log(s),this.$emit("updateDelivery",s)}else console.log("Доставка не найдена",e)}),console.log(this.menu[e])}},mounted(){this.updateMenuData()}},H={class:"activity__options"},R=["onClick"];function Q(e,o,a,s,n,i){return h(),u("section",H,[(h(!0),u(w,null,C(n.menu,r=>(h(),u("div",{class:"options",key:r.id},[t("button",{class:"options-button",onClick:m=>i.selectedOptions(r.id)},_(r.title)+" ("+_(r.delivery?r.delivery.counter:0)+") ",9,R)]))),128))])}const x=k(J,[["render",Q],["__scopeId","data-v-3204104e"]]),G={data(){return{infoDelivery:this.clickedInfoUser,activeId:null}},props:{clickedInfoUser:{type:Object,required:!0},stateModal:{type:Boolean}},computed:{checkInfoUser(){return this.clickedInfoUser},checkId(){return this.clickedInfoUser.clickedInfo.id}},methods:{open2(){S({message:"Вы взялись за заказ!",type:"success"})},toHome(){this.$emit("editStateModal",!1),this.$emit("updateData",!0)},async changeStatus(e){let o=String(e);console.log("итоговый id",{id:o}),console.log(e),await fetch("https://musorok.online:8000/update_delivery_in_progress/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:o})}).then(s=>{if(s.ok)return s;throw new Error("Ошибка при отправке данных")}).then(s=>{console.log("Обновил статус: ",s),this.$emit("updateStateModal",!1),this.open2()}).catch(s=>{console.error("Произошла ошибка: ",s)})}}},Z=e=>($("data-v-6b61ef56"),e=e(),P(),e),Y={class:"modal__delivery"},X={class:"info__id"},K={class:"exit"},ee=Z(()=>t("span",null,[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[t("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})])],-1)),te=[ee],oe={class:"info__comment"},se={class:"detail__info"},ie={class:"time__info"},ne={class:"info__task"},le={class:"info__address"},ae={class:"info__name"},re={class:"in__working"};function de(e,o,a,s,n,i){return M((h(),u("div",Y,[(h(!0),u(w,null,C(i.checkInfoUser,r=>(h(),u("div",{class:"all__info",key:r.id},[t("div",X,[t("div",K,[t("button",{onClick:o[0]||(o[0]=(...m)=>i.toHome&&i.toHome(...m))},te)]),t("p",null,"ID: "+_(r.id),1)]),t("div",oe,[t("p",null,_(r.comment),1)]),t("div",se,[t("div",ie,[t("p",null,[I(" Интервал: "),t("span",null,_(`${r.delivery_dt} ${r.interval}`),1)])]),t("div",ne,[t("p",null,[I(" Задание: "),t("span",null,_(r.meeting_name),1)])]),t("div",le,[t("p",null,[I(" Адрес: "),t("span",null,_(r.full_adress),1)])]),t("div",ae,[t("p",null,[I(" Клиент: "),t("span",null,_(r.client_name),1)])])])]))),128)),t("div",re,[t("button",{plain:!0,onClick:o[1]||(o[1]=r=>i.changeStatus(i.checkId))}," Взять в работу! ")])],512)),[[b,a.stateModal]])}const ce=k(G,[["render",de],["__scopeId","data-v-6b61ef56"]]),he={props:{showConfirmDelivery:{type:Boolean},saveID:{type:Number},questions:{type:Array}},computed:{getQuestions(){return this.questions},showModal(){return this.showConfirmDelivery},getId(){return this.saveID}},methods:{open2(){S({message:"Заказ завершен!",type:"success"})},editStateModalConfirm(){this.$emit("updateStateModalConfirm",!1)},hiddenAllModal(){this.$emit("resetModal",!1)},async postDataQuestionnaire(e){let o=String(e);console.log(e),await fetch("https://musorok.online:8000/save_meeting_questions",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:this.getQuestions}).then(a=>{if(a.ok)return a;throw new Error("Ошибка при отправке данных")}).then(a=>{console.log("Загрузил данные!: ",a),this.completeDelivery(o)}).catch(a=>{console.error("Произошла ошибка: ",a)})},async completeDelivery(e){await fetch("https://musorok.online:8000/update_delivery_done/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(o=>{if(o.ok)return o;throw new Error("Ошибка при отправке данных")}).then(o=>{console.log("Обновил статус: ",o),this.open2()}).catch(o=>{console.error("Произошла ошибка: ",o)}),this.editStateModalConfirm(),this.hiddenAllModal()}}},A=e=>($("data-v-8ab2723e"),e=e(),P(),e),ue={class:"confirm__completion"},_e=A(()=>t("div",{class:"completion__title"},[t("h2",null," Завершить активность? Внимание! Данное действие нельзя будет отменить ")],-1)),pe={class:"completion__btns"},me=A(()=>t("button",null,"Отменить",-1)),ve=[me],ye={class:"btns__save"};function ge(e,o,a,s,n,i){return h(),T(B,{name:"showConfirm"},{default:U(()=>[M(t("div",ue,[_e,t("div",pe,[t("div",{class:"btns__cancel",onClick:o[0]||(o[0]=(...r)=>i.editStateModalConfirm&&i.editStateModalConfirm(...r))},ve),t("div",ye,[t("button",{plain:!0,onClick:o[1]||(o[1]=r=>i.postDataQuestionnaire(i.getId))}," Завершить ")])])],512),[[b,i.showModal]])]),_:1})}const fe=k(he,[["render",ge],["__scopeId","data-v-8ab2723e"]]),De={components:{ConfirmCompletionDelivery:fe},data(){return{infoDelivery:this.clickedInfoUser,activeId:null,showConfirmDelivery:!1,saveID:null,selectedValues:{},fileListMap:{},loading:!1,questions:null,highlightedFields:[]}},props:{clickedInfoUser:{type:Object,required:!0},stateModalComplete:{type:Boolean}},computed:{checkInfoUser(){return this.clickedInfoUser},checkId(){return this.saveID=this.clickedInfoUser.clickedInfo.id,this.clickedInfoUser.clickedInfo.id},saveActionsId(){return this.saveID}},methods:{...V(["getUserId"]),async uploadFile(e,o,a){const{file:s}=e,n=new FormData,i=`${o}_${this.getUserId()}_${a}.jpg`,r="meetings_file";n.append("files",s,i),this.loading=!0;const m="eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsImtpZCI6IjFrYnhacFJNQGJSI0tSbE1xS1lqIn0.eyJ1c2VyIjoiamt3ZTQ1IiwidHlwZSI6ImFwaV9rZXkiLCJwb3J0YWxfdG9rZW4iOiI2MzkwOTkxMy0wOGNkLTRmMjUtOTI1Ni1kMDAyODQzNDY3NzciLCJhcGlfa2V5X2lkIjoiYmUyNzc5OTgtYzgwNC00OGI2LWE2NmMtMDUyOTk0ODIwM2M3IiwiaWF0IjoxNzE3NTExNzU2fQ.n80HrR1rLCbWD6bNcpKl9_Qp1ZX0bdjKEBaWYtPqbze5QaQ0ArMrO9fVO-al3Ji24jguPm30cHSYbTS175o_NKXH1NGtZUVctiEbjDeYCux6wimWMuH36GMiiR38-Jrk-u8G-kOhcmXNaJKmfqbEEyyZNhoiJydrWQpFaYXMRiLfN2og-Pd_sEwV3D3F0GxodjRUf7dn7i8kmLHglOKIac420oRJ0-NzaWrUDZkgTVc_V5IP3eFYDJavdqZgEInHdJUUMo8bx3tPdYHKV4a1y4UZJsgPRptxNfJU2AGQuPogVBvTlYrlThx-pVhQkVJh0B7KPXXFBVgwrZpCkEVqmeTGGPtwxzEGKZSUdiAI3EB0pBkYv3cPIw3lQ2oIhQiEXDHcwEG7CC7GhXFrx1OPVHzfvBWZViB1R1MuzeVeTNi6IrS3rB542SkzgRHDVTOlYvBwkunfT0VksZW8VdRRe6FtQio9OkAACrdnI6qXxQZ_k-pyBJ7842TGtkhdOm6O";try{const l=await fetch(`https://api.timeweb.cloud/api/v1/storages/buckets/306097/object-manager/upload?path=${encodeURIComponent(r)}`,{method:"POST",headers:{Authorization:`Bearer ${m}`},body:n});l.ok?(console.log(l),S.success("Файл успешно загружен!"),this.loading=!1,this.fileListMap[o]||(this.fileListMap[o]=[]),this.fileListMap[o].push(s),console.log(this.fileListMap)):(S.error("Ошибка загрузки файла."),this.loading=!1)}catch(l){console.error("File upload error:",l),S.error("Произошла ошибка"),this.loading=!1}},handleRemove(e,o){console.log(e,o)},handlePreview(e){console.log(e)},resetModal(e){this.$emit("resetModals",e)},hiddenModal(e){this.showConfirmDelivery=e},updateStateModalConfirm(e){this.showConfirmDelivery=e},hiddenModal(e){const o=document.querySelector(".modal__confirm");(e===o||e.target.nodeName!="BUTTON")&&(this.showConfirmDelivery=!1)},toHome(){this.$emit("editStateModal",!1),this.$emit("updateData",!0)},completeDelivery(e){let o=this.checkInfoUser,a=this.selectedValues,s;console.log(this.saveID);function n(c){for(let y in c)s=c[y];return s}s=n(o);const i=this.isFormComplete(s);let r=s.scenario_elements,m=Object.keys(a).map(c=>parseInt(c)),l=[];m.forEach(c=>{let y=r.find(g=>g.ordinal===c),p=a[c],v={question:y.element_name,answer:p};l.push(v)}),console.log(this.clickedInfoUser.clickedInfo.id);let d={meeting_id:this.clickedInfoUser.clickedInfo.id,questions:l};this.questions=JSON.stringify(d),console.log(this.questions),this.highlightedFields=[],r.forEach(c=>{c.element_type==="dropdown"&&!this.selectedValues[c.ordinal]&&this.highlightedFields.push(c.ordinal)}),r.forEach(c=>{c.element_type==="photo_upload"&&(!this.fileListMap[s.id]||this.fileListMap[s.id].length===0)&&this.highlightedFields.push(c.ordinal)}),i&&this.highlightedFields.length===0&&(this.showConfirmDelivery=!0)},isFormComplete(e){const o=e.scenario_elements.filter(s=>s.element_type==="photo_upload").every(s=>this.fileListMap[e.id]&&this.fileListMap[e.id].length>=2),a=e.scenario_elements.filter(s=>s.element_type==="dropdown").every(s=>this.selectedValues[s.ordinal]);return o&&a},removeHighlight(e){const o=this.highlightedFields.indexOf(e);o!==-1&&this.highlightedFields.splice(o,1)}}},E=e=>($("data-v-8365bba7"),e=e(),P(),e),Ie={class:"info__id"},we={class:"exit"},Me=E(()=>t("span",null,[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[t("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})])],-1)),ke=[Me],Ce={class:"info__comment"},Se={class:"detail__info"},be={class:"time__info"},Ue={class:"info__task"},$e={class:"info__address"},Pe={class:"info__name"},Oe={key:0,class:"upload__photo"},Te=E(()=>t("input",{class:"custom_fileInput",type:"file",accept:"image/*",capture:"camera"},null,-1)),Ve={key:1,class:"info__problem"},We={class:"complete"},Le=["onClick"];function Ne(e,o,a,s,n,i){const r=f("el-button"),m=f("el-upload"),l=f("el-option"),d=f("el-select"),c=f("ConfirmCompletionDelivery"),y=W("loading");return M((h(),u("div",{class:"modal__delivery",onClick:o[1]||(o[1]=p=>i.hiddenModal(p))},[(h(!0),u(w,null,C(i.checkInfoUser,p=>(h(),u("div",{class:"all__info",key:p.id},[t("div",Ie,[t("div",we,[t("button",{onClick:o[0]||(o[0]=(...v)=>i.toHome&&i.toHome(...v))},ke)]),t("p",null,"ID: "+_(p.id),1)]),t("div",Ce,[t("p",null,_(p.comment),1)]),t("div",Se,[t("div",be,[t("p",null,[I(" Интервал: "),t("span",null,_(`${p.delivery_dt} ${p.interval}`),1)])]),t("div",Ue,[t("p",null,[I(" Задание: "),t("span",null,_(p.meeting_name),1)])]),t("div",$e,[t("p",null,[I(" Адрес: "),t("span",null,_(p.full_adress),1)])]),t("div",Pe,[t("p",null,[I(" Клиент: "),t("span",null,_(p.client_name),1)])])]),(h(!0),u(w,null,C(p.scenario_elements,v=>(h(),u("div",{class:"dynamics__info",key:v.ordinal},[t("p",null,_(v.element_name),1),v.element_type==="photo_upload"?(h(),u("div",Oe,[M((h(),T(m,{"file-list":n.fileListMap[p.id[0]],key:v.ordinal,"http-request":g=>i.uploadFile(g,p.id,v.ordinal),class:"upload-demo","on-preview":i.handlePreview,"on-remove":i.handleRemove,"list-type":"picture",multiple:"",accept:"image/*"},{default:U(()=>[D(r,{type:"primary"},{default:U(()=>[Te]),_:1})]),_:2},1032,["file-list","http-request","on-preview","on-remove"])),[[y,n.loading]])])):L("",!0),v.element_type==="dropdown"?(h(),u("div",Ve,[D(d,{modelValue:n.selectedValues[v.ordinal],"onUpdate:modelValue":g=>n.selectedValues[v.ordinal]=g,placeholder:"Выберите вариант",size:"large",class:j({"highlight-border":n.highlightedFields.includes(v.ordinal)}),onChange:g=>i.removeHighlight(v.ordinal)},{default:U(()=>[(h(!0),u(w,null,C(v.options,g=>(h(),T(l,{key:g,label:g,value:g},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","class","onChange"])])):L("",!0)]))),128)),t("div",We,[t("button",{onClick:v=>i.completeDelivery(p.id)},"Завершить",8,Le)])]))),128)),D(c,{class:"modal__confirm",showConfirmDelivery:n.showConfirmDelivery,onResetModal:i.resetModal,onUpdateStateModalConfirm:i.updateStateModalConfirm,saveID:n.saveID,onHiddenModal:i.hiddenModal,questions:n.questions},null,8,["showConfirmDelivery","onResetModal","onUpdateStateModalConfirm","saveID","onHiddenModal","questions"])],512)),[[b,a.stateModalComplete]])}const je=k(De,[["render",Ne],["__scopeId","data-v-8365bba7"]]),xe={components:{ModalInfoDeliveryAgent:ce,ModalCompleteDelivery:je},data(){return{date:null,infoDelivery:null,showInfoDelivery:!0,clickedInfoUser:{},stateModal:!1,loading:!0,showWarning:!1,statusDelivery:null,stateModalComplete:!1}},props:{selectedDate:{type:String},reDelivery:{type:Object},titleDelivery:{type:String}},watch:{selectedDate(e){this.date=e,this.checkUserId()},reDelivery(){this.reDelivery[0]?this.showWarning=!1:this.showWarning=!0},titleDelivery(e){this.statusDelivery=e}},computed:{...V(["getUserId"])},methods:{resetModals(e){this.stateModalComplete=e,this.getDeliveryAgentOrdersById(this.getUserId,this.date)},updateStateModal(e){this.stateModal=e,this.stateModalComplete=e,this.getDeliveryAgentOrdersById(this.getUserId,this.date)},updateData(e){e===!0?(console.log("обновил"),this.getDeliveryAgentOrdersById(this.getUserId,this.date)):console.log("не обновил")},editStateModal(e){this.stateModal=e,this.stateModalComplete=e},getValueFromProxy(e){this.statusDelivery==="Warning"?this.stateModal=!0:this.statusDelivery==="inProgress"&&(this.stateModalComplete=!0);const a=this.infoDelivery.find(s=>s.id===e);this.clickedInfoUser.clickedInfo=a,console.log(this.clickedInfoUser)},checkUserId(){this.date!==""?(console.log("получил",this.date),this.getDeliveryAgentOrdersById(this.getUserId,this.date)):console.log("ничего не отправил!")},async getDeliveryAgentOrdersById(e,o){console.log({newDate:o,newId:e}),this.loading=!0;try{const s=await fetch(`https://musorok.online:8000/delivery_agent_orders/${e}`,{method:"POST",headers:{accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({order_date:o})});if(!s.ok)throw new Error("Ошибка при отправке данных");const n=await s.json();console.log("Данные отправлены!",n);let i=n.filter(l=>l.meeting_status==="In progress"),r=n.filter(l=>l.meeting_status==="Waiting"),m=n.filter(l=>l.meeting_status==="Done"||l.meeting_status==="Canceling");this.deliveryInProgress=i,this.$emit("deliveryWaiting",r),this.$emit("deliveryInProgress",i),this.$emit("deliveryInfoDone",m),this.infoDelivery=n,this.showInfoDelivery=!0,this.loading=!1,this.infoDelivery.forEach((l,d)=>{setTimeout(()=>{const c=document.querySelectorAll(".block__order");c[d].style.animationDelay=`${d*.1}s`},d*100)})}catch(s){console.error("Произошла ошибка: ",s)}}},mounted(){this.date=this.selectedDate,this.checkUserId}},Ae=e=>($("data-v-08aa3a70"),e=e(),P(),e),Ee={class:"load"},Fe={class:"orders__block"},Be=["onClick"],ze={class:"order__interval"},qe={class:"interval__start"},Je={class:"interval__end"},He={class:"order__client"},Re={class:"client__name"},Qe={class:"client__address"},Ge={class:"showWarning"},Ze=Ae(()=>t("p",null,"Нет заказов",-1)),Ye=[Ze];function Xe(e,o,a,s,n,i){const r=f("ModalInfoDeliveryAgent"),m=f("ModalCompleteDelivery"),l=W("loading");return h(),u(w,null,[M((h(),u("div",Ee,[(h(!0),u(w,null,C(a.reDelivery,d=>M((h(),u("div",Fe,[t("div",{class:j(["block__order",{done:d.meeting_status==="Done",canceling:d.meeting_status==="Canceling"}]),onClick:c=>i.getValueFromProxy(d.id)},[t("div",ze,[t("div",qe,_(d.start_time),1),t("div",Je,_(d.end_time),1)]),t("div",He,[t("div",Re,[t("p",null,_(d.client_name),1)]),t("div",Qe,[t("p",null,_(d.full_adress),1)])])],10,Be)],512)),[[b,n.showInfoDelivery]])),256))])),[[l,n.loading]]),M(t("div",Ge,Ye,512),[[b,n.showWarning]]),D(r,{clickedInfoUser:n.clickedInfoUser,stateModal:n.stateModal,onEditStateModal:i.editStateModal,onUpdateData:i.updateData,onUpdateStateModal:i.updateStateModal},null,8,["clickedInfoUser","stateModal","onEditStateModal","onUpdateData","onUpdateStateModal"]),D(m,{clickedInfoUser:n.clickedInfoUser,stateModalComplete:n.stateModalComplete,onResetModals:i.resetModals,onEditStateModal:i.editStateModal,onUpdateData:i.updateData,onUpdateStateModal:i.updateStateModal},null,8,["clickedInfoUser","stateModalComplete","onResetModals","onEditStateModal","onUpdateData","onUpdateStateModal"])],64)}const F=k(xe,[["render",Xe],["__scopeId","data-v-08aa3a70"]]),Ke={class:"demo-date-picker"},et={class:"block"},tt={data(){return{loadPage:!1,newDeliveryWaiting:null,newDeliveryInProgress:null,newDeliveryDone:null,reDelivery:null,titleDelivery:null}},components:{ActivityMenu:x,DeliveryAgentOrders:F},methods:{getTitleDelivery(e){this.titleDelivery=e},updateValueDelivery(e){this.reDelivery=e},loadPage(){console.log("отработал"),this.$emit("loadingPage",!1)},addDeliveryWaiting(e){const o={status:"Ожидание",value:e,counter:e.length};this.newDeliveryWaiting=o,console.log(o)},addDeliveryInProgress(e){const o={status:"В процессе",value:e,counter:e.length};this.newDeliveryInProgress=o,console.log(o)},addDeliveryDone(e){const o={status:"Завершил",value:e,counter:e.length};this.newDeliveryDone=o,console.log(o)}},mounted(){const e=document.querySelector('th[aria-label="Sunday"]'),o=document.querySelector('th[aria-label="Monday"]'),a=document.querySelector('th[aria-label="Tuesday"]'),s=document.querySelector('th[aria-label="Wednesday"]'),n=document.querySelector('th[aria-label="Thursday"]'),i=document.querySelector('th[aria-label="Friday"]'),r=document.querySelector('th[aria-label="Saturday"]');e?(e.textContent="Пн",o.textContent="Вт",a.textContent="Ср",s.textContent="Чт",n.textContent="Птн",i.textContent="Сб",r.textContent="Вс"):console.error('Элемент с aria-label="Sunday" не найден.')}},ot=Object.assign(tt,{__name:"SelectedDate",setup(e){const o=O("default"),a=O(""),s=O(""),n=l=>{if(!l)return"";const d=new Date(l),c=d.getFullYear(),y=`0${d.getMonth()+1}`.slice(-2),p=`0${d.getDate()}`.slice(-2);return`${c}-${y}-${p}`},i=l=>{const d=new Date,c=new Date(d);c.setDate(d.getDate()+1);const y=new Date(c);return y.setHours(23,59,59,999),l<=y};z(a,l=>{const d=new Date(l);i(d)?(s.value=n(l),console.log(s.value)):(console.error("Выбранная дата за пределами допустимого диапазона."),a.value="")});const r=l=>{const d=new Date,c=new Date(d);return c.setDate(d.getDate()+1),l.getTime()>c.getTime()},m=()=>{const{emit:l}=q();l("loadingPage",!1)};return N(()=>{m()}),N(()=>{const l=new Date;a.value=n(l)}),(l,d)=>{const c=f("el-date-picker");return h(),u(w,null,[t("div",Ke,[t("div",et,[D(c,{modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=y=>a.value=y),type:"date",placeholder:"Выберите дату!",size:o.value,"disabled-date":r},null,8,["modelValue","size"])])]),D(x,{newDeliveryWaiting:l.newDeliveryWaiting,newDeliveryInProgress:l.newDeliveryInProgress,newDeliveryDone:l.newDeliveryDone,onUpdateDelivery:l.updateValueDelivery,onPostTitleDelivery:l.getTitleDelivery},null,8,["newDeliveryWaiting","newDeliveryInProgress","newDeliveryDone","onUpdateDelivery","onPostTitleDelivery"]),D(F,{onDeliveryWaiting:l.addDeliveryWaiting,onDeliveryInProgress:l.addDeliveryInProgress,onDeliveryInfoDone:l.addDeliveryDone,selectedDate:s.value,reDelivery:l.reDelivery,titleDelivery:l.titleDelivery},null,8,["onDeliveryWaiting","onDeliveryInProgress","onDeliveryInfoDone","selectedDate","reDelivery","titleDelivery"])],64)}}}),st=k(ot,[["__scopeId","data-v-1768d8a4"]]),it={components:{SelectedDate:st},data(){return{loading:!0,reload:null}},computed:{...V(["getUserId"]),userID(){return this.getUserId}},methods:{editLoading(e){this.loading=e},postCourierLocation(){navigator.geolocation.getCurrentPosition(e=>{const o=e.coords.latitude,a=e.coords.longitude,s={courier_id:this.userID,latitude:o,longitude:a};fetch("https://musorok.online:8000/courier_locations/",{method:"POST",headers:{accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then(n=>{if(n.ok)return n;throw new Error("Не удалось получить локацию курьера")}).then(n=>{console.log("отправил локацию в активности",n)}).catch(n=>{console.error("Произошла ошибка отправки локации:",n)})})}},mounted(){this.postCourierLocation()}},nt={class:"activity__page"};function lt(e,o,a,s,n,i){const r=f("SelectedDate"),m=W("loading");return M((h(),u("div",nt,[D(r,{onLoadingPage:i.editLoading},null,8,["onLoadingPage"])])),[[m,n.loading]])}const rt=k(it,[["render",lt],["__scopeId","data-v-c734d85e"]]);export{rt as default};
